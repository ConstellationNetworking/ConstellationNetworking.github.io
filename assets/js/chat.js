const a0_0x246218=a0_0x5206;function a0_0x29d9(){const _0x1d38fb=['chatId','12525384xILaId','push','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-400\x22>','exists','\x0a\x20\x20\x20\x20','FieldValue','value','scrollHeight','/signin.html','forEach','chat-sidebar-list','update','30PZneyq','createElement','Enter','profilePic','justify-end','Messages','uid','click','2-digit','Chat','location','\x22\x20class=\x22w-10\x20h-10\x20rounded-full\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>','24935AhDKgB','data','chat-header','onSnapshot','getElementById','136371ZpREWj','toLowerCase','461004dzBIPr','filter','Users','\x0a\x20\x20','name','email','then','includes','\x0a\x20\x20\x20\x20<img\x20src=\x22','doc','className','profileIMG','keydown','\x22\x20class=\x22w-8\x20h-8\x20rounded-full\x22>\x0a\x20\x20\x20\x20','messageText','div','sort','get','</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','appendChild','arrayUnion','empty','firestore','</span>\x0a\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22','chat-input','1194VmHvne','946300PYYZMr','href','You','chat-messages','Unknown','userHistory','/assets/img/default_user.jpeg','where','innerHTML','\x22\x20class=\x22w-8\x20h-8\x20rounded-full\x22>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22max-w-xs\x20bg-gray-200\x20text-black\x20rounded-lg\x20px-3\x20py-2\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22','auth','9106006DYeVPc','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-400\x20mt-1\x22>','trim','add','p-4\x20flex\x20items-center\x20space-x-2\x20hover:bg-gray-100\x20cursor-pointer','textContent','250461mSfSQI','userId','target','search','docs','collection','orderBy','</span>\x0a\x20\x20','addEventListener','flex\x20items-start\x20space-x-3\x20','toLocaleTimeString','\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20flex-col\x20items-end\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22max-w-xs\x20bg-blue-500\x20text-white\x20rounded-lg\x20px-3\x20py-2\x22>','6hwsfVH','senderId'];a0_0x29d9=function(){return _0x1d38fb;};return a0_0x29d9();}(function(_0x514fb3,_0xda3048){const _0x1dbc5e=a0_0x5206,_0x27dc61=_0x514fb3();while(!![]){try{const _0x14235b=-parseInt(_0x1dbc5e(0x1d1))/0x1+-parseInt(_0x1dbc5e(0x1b1))/0x2*(parseInt(_0x1dbc5e(0x1d3))/0x3)+parseInt(_0x1dbc5e(0x193))/0x4+-parseInt(_0x1dbc5e(0x1cc))/0x5*(-parseInt(_0x1dbc5e(0x192))/0x6)+-parseInt(_0x1dbc5e(0x19f))/0x7+parseInt(_0x1dbc5e(0x1b4))/0x8+-parseInt(_0x1dbc5e(0x1a5))/0x9*(parseInt(_0x1dbc5e(0x1c0))/0xa);if(_0x14235b===_0xda3048)break;else _0x27dc61['push'](_0x27dc61['shift']());}catch(_0x285ca8){_0x27dc61['push'](_0x27dc61['shift']());}}}(a0_0x29d9,0xc678d));const sidebarList=document[a0_0x246218(0x1d0)](a0_0x246218(0x1be)),chatMessages=document[a0_0x246218(0x1d0)](a0_0x246218(0x196)),chatInput=document[a0_0x246218(0x1d0)](a0_0x246218(0x191)),sendButton=document[a0_0x246218(0x1d0)]('send-btn'),searchInput=document[a0_0x246218(0x1d0)]('user-search-email'),allSidebarUsers=[];let CURRENT_USER_ID=null,CURRENT_USER_NAME='',CURRENT_USER_PIC='/assets/img/default_user.jpeg',lastTimestamp=null,unsubscribeMessages=null;firebase[a0_0x246218(0x19e)]()['onAuthStateChanged'](async _0x3c4e1b=>{const _0x952aaf=a0_0x246218;if(!_0x3c4e1b)return window[_0x952aaf(0x1ca)][_0x952aaf(0x194)]=_0x952aaf(0x1bc);CURRENT_USER_ID=_0x3c4e1b[_0x952aaf(0x1c6)];const _0x574d09=await firebase[_0x952aaf(0x1e9)]()[_0x952aaf(0x1aa)]('Users')[_0x952aaf(0x1dc)](CURRENT_USER_ID)['get'](),_0x4a549e=_0x574d09[_0x952aaf(0x1cd)]();CURRENT_USER_NAME=_0x4a549e[_0x952aaf(0x1d7)]||_0x952aaf(0x195),CURRENT_USER_PIC=_0x4a549e[_0x952aaf(0x1de)]||_0x952aaf(0x199),loadSidebarFromUserHistory(_0x4a549e[_0x952aaf(0x198)]||{});const _0x3ab9e0=new URLSearchParams(window[_0x952aaf(0x1ca)][_0x952aaf(0x1a8)]),_0x16a455=_0x3ab9e0['get']('chat');_0x16a455&&firebase[_0x952aaf(0x1e9)]()[_0x952aaf(0x1aa)](_0x952aaf(0x1d5))[_0x952aaf(0x1dc)](_0x16a455)['get']()['then'](_0x1d9722=>{const _0x103f02=_0x952aaf;if(_0x1d9722['exists']){const _0x20d9d4=_0x1d9722['data']();document['getElementById'](_0x103f02(0x1ce))[_0x103f02(0x1a4)]=_0x20d9d4[_0x103f02(0x1d7)]||_0x103f02(0x1c9),activeUserId=_0x16a455,loadChatHistory(_0x16a455);}});});function loadSidebarFromUserHistory(_0x54eb86){const _0x37ba11=a0_0x246218;_0x54eb86[_0x37ba11(0x1bd)](_0x1df950=>{const _0x30d203=_0x37ba11;firebase['firestore']()[_0x30d203(0x1aa)](_0x30d203(0x1d5))[_0x30d203(0x1dc)](_0x1df950)[_0x30d203(0x1e4)]()[_0x30d203(0x1d9)](_0x43c6d3=>{const _0x517a19=_0x30d203;if(_0x43c6d3[_0x517a19(0x1b7)]){const _0x557104=_0x43c6d3['data'](),_0x36b7b1=_0x557104['name']||_0x517a19(0x197),_0x228eb6=_0x557104[_0x517a19(0x1de)]||'/assets/img/default_user.jpeg',_0x1e2d80=_0x557104[_0x517a19(0x1d8)]||'';add_to_sidebar(_0x36b7b1,_0x228eb6,_0x1df950,_0x1e2d80);}});});}function add_to_sidebar(_0x59efc7,_0x2076b6,_0x2c0a6f,_0x4f7050){const _0x5288a0=a0_0x246218,_0x2a71f9=document[_0x5288a0(0x1c1)]('li');_0x2a71f9[_0x5288a0(0x1dd)]=_0x5288a0(0x1a3),_0x2a71f9['innerHTML']=_0x5288a0(0x1db)+_0x2076b6+'\x22\x20class=\x22w-10\x20h-10\x20rounded-full\x22>\x0a\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>'+_0x59efc7+_0x5288a0(0x1ac),_0x2a71f9[_0x5288a0(0x1ad)](_0x5288a0(0x1c7),()=>{const _0x57a376=_0x5288a0;document[_0x57a376(0x1d0)](_0x57a376(0x1ce))[_0x57a376(0x1a4)]=_0x59efc7,chatMessages[_0x57a376(0x19b)]='',activeUserId=_0x2c0a6f,loadChatHistory(_0x2c0a6f);}),sidebarList[_0x5288a0(0x1e6)](_0x2a71f9),allSidebarUsers[_0x5288a0(0x1b5)]({'name':_0x59efc7,'profilePic':_0x2076b6,'userId':_0x2c0a6f,'email':_0x4f7050});}function updateSidebarList(_0x5442fc){const _0x442d96=a0_0x246218;sidebarList[_0x442d96(0x19b)]='';const _0x18b60b=_0x5442fc[_0x442d96(0x1d2)]();allSidebarUsers[_0x442d96(0x1d4)](_0x393523=>_0x393523['name']['toLowerCase']()[_0x442d96(0x1da)](_0x18b60b)||_0x393523[_0x442d96(0x1a6)][_0x442d96(0x1d2)]()[_0x442d96(0x1da)](_0x18b60b)||_0x393523[_0x442d96(0x1d8)][_0x442d96(0x1d2)]()['includes'](_0x18b60b))['forEach'](_0x3abe94=>{const _0x1874a4=_0x442d96,_0x5eba1a=document['createElement']('li');_0x5eba1a[_0x1874a4(0x1dd)]=_0x1874a4(0x1a3),_0x5eba1a[_0x1874a4(0x19b)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3abe94[_0x1874a4(0x1c3)]+_0x1874a4(0x1cb)+_0x3abe94['name']+_0x1874a4(0x1ea),_0x5eba1a[_0x1874a4(0x1ad)]('click',()=>{const _0x290064=_0x1874a4;document[_0x290064(0x1d0)](_0x290064(0x1ce))[_0x290064(0x1a4)]=_0x3abe94[_0x290064(0x1d7)],chatMessages[_0x290064(0x19b)]='',activeUserId=_0x3abe94['userId'],loadChatHistory(_0x3abe94['userId']);}),sidebarList[_0x1874a4(0x1e6)](_0x5eba1a);}),sidebarList['children']['length']===0x0&&_0x5442fc[_0x442d96(0x1da)]('@')&&firebase['firestore']()[_0x442d96(0x1aa)]('Users')[_0x442d96(0x19a)](_0x442d96(0x1d8),'==',_0x5442fc)[_0x442d96(0x1e4)]()[_0x442d96(0x1d9)](_0x441dbc=>{const _0x23a431=_0x442d96;if(!_0x441dbc[_0x23a431(0x1e8)]){const _0x4f8d6e=_0x441dbc[_0x23a431(0x1a9)][0x0],_0x1fd8da=_0x4f8d6e[_0x23a431(0x1cd)](),_0x543d65=_0x4f8d6e['id'],_0x45692f=_0x1fd8da[_0x23a431(0x1d7)]||_0x23a431(0x197),_0x4b0f66=_0x1fd8da['profileIMG']||_0x23a431(0x199),_0x56fa19=_0x1fd8da['email']||'';add_to_sidebar(_0x45692f,_0x4b0f66,_0x543d65,_0x56fa19),updateSidebarList(_0x5442fc);}});}searchInput[a0_0x246218(0x1ad)]('input',_0x4c9986=>{const _0x467557=a0_0x246218;updateSidebarList(_0x4c9986[_0x467557(0x1a7)][_0x467557(0x1ba)]);});function a0_0x5206(_0x13df8d,_0x22cf23){const _0x29d94b=a0_0x29d9();return a0_0x5206=function(_0x52065b,_0x3ec4c3){_0x52065b=_0x52065b-0x191;let _0x181303=_0x29d94b[_0x52065b];return _0x181303;},a0_0x5206(_0x13df8d,_0x22cf23);}function add_message(_0x43836c,_0x131449,_0x4d2253,_0x322ded,_0x427573){const _0xf1d531=a0_0x246218,_0x10c718=document[_0xf1d531(0x1c1)](_0xf1d531(0x1e2));_0x10c718['className']=_0xf1d531(0x1ae)+(_0x131449?_0xf1d531(0x1c4):'');const _0x3e03b8=new Date()[_0xf1d531(0x1af)]([],{'hour':_0xf1d531(0x1c8),'minute':_0xf1d531(0x1c8)});_0x10c718[_0xf1d531(0x19b)]=_0xf1d531(0x1b8)+(_0x131449?_0xf1d531(0x1b0)+_0x427573+_0xf1d531(0x1a0)+_0x3e03b8+_0xf1d531(0x19d)+_0x322ded+_0xf1d531(0x1e0):_0xf1d531(0x1eb)+_0x322ded+_0xf1d531(0x19c)+_0x427573+_0xf1d531(0x1b6)+_0x3e03b8+_0xf1d531(0x1e5))+_0xf1d531(0x1d6),chatMessages['appendChild'](_0x10c718),chatMessages['scrollTop']=chatMessages[_0xf1d531(0x1bb)];}sendButton[a0_0x246218(0x1ad)](a0_0x246218(0x1c7),()=>{const _0x2af5af=a0_0x246218,_0x444f90=chatInput[_0x2af5af(0x1ba)][_0x2af5af(0x1a1)]();if(!_0x444f90)return;firebase[_0x2af5af(0x1e9)]()[_0x2af5af(0x1aa)](_0x2af5af(0x1c5))[_0x2af5af(0x1a2)]({'senderId':CURRENT_USER_ID,'receiverId':activeUserId,'chatId':getChatId(CURRENT_USER_ID,activeUserId),'messageText':_0x444f90,'timestamp':firebase[_0x2af5af(0x1e9)][_0x2af5af(0x1b9)]['serverTimestamp']()}),firebase[_0x2af5af(0x1e9)]()['collection'](_0x2af5af(0x1d5))[_0x2af5af(0x1dc)](CURRENT_USER_ID)[_0x2af5af(0x1bf)]({'userHistory':firebase[_0x2af5af(0x1e9)][_0x2af5af(0x1b9)][_0x2af5af(0x1e7)](activeUserId)}),chatInput[_0x2af5af(0x1ba)]='';}),chatInput[a0_0x246218(0x1ad)](a0_0x246218(0x1df),_0x4706c5=>{const _0x236d16=a0_0x246218;_0x4706c5['key']===_0x236d16(0x1c2)&&sendButton[_0x236d16(0x1c7)]();});function getChatId(_0x316de9,_0x14ed69){const _0x541a79=a0_0x246218;return[_0x316de9,_0x14ed69][_0x541a79(0x1e3)]()['join']('-');}function loadChatHistory(_0x5ec080){const _0x506f39=a0_0x246218,_0x3221fd=getChatId(CURRENT_USER_ID,_0x5ec080);unsubscribeMessages&&(unsubscribeMessages(),unsubscribeMessages=null),firebase['firestore']()[_0x506f39(0x1aa)](_0x506f39(0x1d5))['doc'](_0x5ec080)[_0x506f39(0x1e4)]()['then'](_0x15140a=>{const _0x34b4fe=_0x506f39,_0x3581a3=_0x15140a[_0x34b4fe(0x1cd)](),_0x3537e9=_0x3581a3?.[_0x34b4fe(0x1d7)]||'Other',_0x49e70b=_0x3581a3?.['profileIMG']||_0x34b4fe(0x199);unsubscribeMessages=firebase['firestore']()[_0x34b4fe(0x1aa)](_0x34b4fe(0x1c5))[_0x34b4fe(0x19a)](_0x34b4fe(0x1b3),'==',_0x3221fd)[_0x34b4fe(0x1ab)]('timestamp')[_0x34b4fe(0x1cf)](_0xa56be4=>{const _0x204234=_0x34b4fe;chatMessages[_0x204234(0x19b)]='',_0xa56be4[_0x204234(0x1bd)](_0x3fb7b9=>{const _0x414ac4=_0x204234,_0x51b48d=_0x3fb7b9['data'](),_0x4f04ab=_0x51b48d[_0x414ac4(0x1b2)]===CURRENT_USER_ID,_0x60a9ad=_0x4f04ab?CURRENT_USER_NAME:_0x3537e9,_0x287596=_0x4f04ab?CURRENT_USER_PIC:_0x49e70b;add_message(_0x51b48d['senderId'],_0x4f04ab,_0x60a9ad,_0x287596,_0x51b48d[_0x414ac4(0x1e1)]);});});});}