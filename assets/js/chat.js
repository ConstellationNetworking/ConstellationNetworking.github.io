const a0_0x3b37a8=a0_0xfa2f;(function(_0x101386,_0x374da0){const _0x416335=a0_0xfa2f,_0x54007c=_0x101386();while(!![]){try{const _0x26a2ff=parseInt(_0x416335(0xd9))/0x1*(-parseInt(_0x416335(0xc5))/0x2)+-parseInt(_0x416335(0xc6))/0x3+-parseInt(_0x416335(0xc1))/0x4*(-parseInt(_0x416335(0xce))/0x5)+parseInt(_0x416335(0xc9))/0x6+-parseInt(_0x416335(0xbc))/0x7*(parseInt(_0x416335(0xe2))/0x8)+-parseInt(_0x416335(0xde))/0x9*(-parseInt(_0x416335(0xcd))/0xa)+parseInt(_0x416335(0xd2))/0xb;if(_0x26a2ff===_0x374da0)break;else _0x54007c['push'](_0x54007c['shift']());}catch(_0x5cc931){_0x54007c['push'](_0x54007c['shift']());}}}(a0_0x1d72,0x656d7));const sidebarList=document[a0_0x3b37a8(0xdc)]('chat-sidebar-list'),chatMessages=document[a0_0x3b37a8(0xdc)]('chat-messages'),chatInput=document[a0_0x3b37a8(0xdc)]('chat-input'),sendButton=document[a0_0x3b37a8(0xdc)](a0_0x3b37a8(0xea)),searchInput=document[a0_0x3b37a8(0xdc)](a0_0x3b37a8(0xfd)),allSidebarUsers=[];let CURRENT_USER_ID=null,CURRENT_USER_NAME='',CURRENT_USER_PIC='/assets/img/default_user.jpeg',lastTimestamp=null,unsubscribeMessages=null;firebase['auth']()['onAuthStateChanged'](async _0x1880d3=>{const _0x1f9075=a0_0x3b37a8;if(!_0x1880d3)return window[_0x1f9075(0xfa)]['href']=_0x1f9075(0xd0);CURRENT_USER_ID=_0x1880d3['uid'];const _0x3f0602=await firebase[_0x1f9075(0xf7)]()[_0x1f9075(0xfc)](_0x1f9075(0xc0))[_0x1f9075(0x103)](CURRENT_USER_ID)[_0x1f9075(0xc2)](),_0x45ce4b=_0x3f0602[_0x1f9075(0x102)]();CURRENT_USER_NAME=_0x45ce4b[_0x1f9075(0xc8)]||'You',CURRENT_USER_PIC=_0x45ce4b[_0x1f9075(0xe4)]||'/assets/img/default_user.jpeg',loadSidebarFromUserHistory(_0x45ce4b[_0x1f9075(0xe5)]||{});const _0x5e8c67=new URLSearchParams(window[_0x1f9075(0xfa)][_0x1f9075(0xcb)]),_0x4ac652=_0x5e8c67[_0x1f9075(0xc2)]('chat');_0x4ac652&&firebase[_0x1f9075(0xf7)]()[_0x1f9075(0xfc)](_0x1f9075(0xc0))[_0x1f9075(0x103)](_0x4ac652)[_0x1f9075(0xc2)]()[_0x1f9075(0xfe)](_0x2dfb3e=>{const _0x30a4bb=_0x1f9075;if(_0x2dfb3e[_0x30a4bb(0xf4)]){const _0x362c21=_0x2dfb3e[_0x30a4bb(0x102)]();document[_0x30a4bb(0xdc)](_0x30a4bb(0xd4))[_0x30a4bb(0x101)]=_0x362c21[_0x30a4bb(0xc8)]||'Chat',activeUserId=_0x4ac652,loadChatHistory(_0x4ac652);}});});function loadSidebarFromUserHistory(_0x1b5798){const _0x47ddbe=a0_0x3b37a8;for(const [_0x17b524,_0x3ccec6]of Object['entries'](_0x1b5798)){firebase[_0x47ddbe(0xf7)]()['collection'](_0x47ddbe(0xc0))[_0x47ddbe(0x103)](_0x17b524)[_0x47ddbe(0xc2)]()[_0x47ddbe(0xfe)](_0x13f390=>{const _0x1199ec=_0x47ddbe,_0x5041c1=_0x13f390[_0x1199ec(0x102)](),_0x21a321=_0x5041c1['profileIMG']||_0x1199ec(0xb7);add_to_sidebar(_0x3ccec6,_0x21a321,_0x17b524,_0x5041c1[_0x1199ec(0x100)]||'');});}}function add_to_sidebar(_0x1af863,_0x1ce39e,_0x76642f,_0x3a7a26){const _0x45fbee=a0_0x3b37a8,_0x27a0b2=document[_0x45fbee(0xf1)]('li');_0x27a0b2[_0x45fbee(0xfb)]=_0x45fbee(0xdf),_0x27a0b2[_0x45fbee(0xe6)]=_0x45fbee(0xf8)+_0x1ce39e+_0x45fbee(0xf3)+_0x1af863+_0x45fbee(0xf9),_0x27a0b2['addEventListener'](_0x45fbee(0xe8),()=>{const _0xb1ffb1=_0x45fbee;document[_0xb1ffb1(0xdc)](_0xb1ffb1(0xd4))[_0xb1ffb1(0x101)]=_0x1af863,chatMessages['innerHTML']='',activeUserId=_0x76642f,loadChatHistory(_0x76642f);}),sidebarList[_0x45fbee(0xb8)](_0x27a0b2),allSidebarUsers[_0x45fbee(0xbf)]({'name':_0x1af863,'profilePic':_0x1ce39e,'userId':_0x76642f,'email':_0x3a7a26});}function updateSidebarList(_0xedcd79){const _0x380a16=a0_0x3b37a8;sidebarList[_0x380a16(0xe6)]='';const _0x1d2d33=_0xedcd79['toLowerCase']();allSidebarUsers[_0x380a16(0xf5)](_0x563c2c=>_0x563c2c['name'][_0x380a16(0xba)]()[_0x380a16(0xd8)](_0x1d2d33)||_0x563c2c['userId']['toLowerCase']()[_0x380a16(0xd8)](_0x1d2d33)||_0x563c2c['email']['toLowerCase']()[_0x380a16(0xd8)](_0x1d2d33))[_0x380a16(0xbb)](_0x6813cb=>{const _0x263542=_0x380a16,_0x3abdd0=document[_0x263542(0xf1)]('li');_0x3abdd0['className']=_0x263542(0xdf),_0x3abdd0['innerHTML']=_0x263542(0xc4)+_0x6813cb[_0x263542(0xef)]+_0x263542(0xe3)+_0x6813cb['name']+_0x263542(0xd5),_0x3abdd0[_0x263542(0xee)]('click',()=>{const _0x1bb43a=_0x263542;document['getElementById']('chat-header')[_0x1bb43a(0x101)]=_0x6813cb[_0x1bb43a(0xc8)],chatMessages[_0x1bb43a(0xe6)]='',activeUserId=_0x6813cb['userId'],loadChatHistory(_0x6813cb[_0x1bb43a(0xb6)]);}),sidebarList[_0x263542(0xb8)](_0x3abdd0);});}function a0_0x1d72(){const _0x355b53=['scrollTop','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','394278NJVsKo','1261971FrXwvP','\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20flex-col\x20items-end\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22max-w-xs\x20bg-blue-500\x20text-white\x20rounded-lg\x20px-3\x20py-2\x22>','name','1013982IFaeiy','\x0a\x20\x20','search','senderId','4371150YbuRUP','84030fycCHv','value','/signin.html','</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22','9388467BaYLeg','Other','chat-header','</span>\x0a\x20\x20\x20\x20\x20\x20','serverTimestamp','sort','includes','1wApije','input','div','getElementById','add','9wMWeDE','p-4\x20flex\x20items-center\x20space-x-2\x20hover:bg-gray-100\x20cursor-pointer','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-400\x20mt-1\x22>','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22','50936pYqGik','\x22\x20class=\x22w-10\x20h-10\x20rounded-full\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>','profileIMG','userHistory','innerHTML','justify-end','click','join','send-btn','toLocaleTimeString','2-digit','\x22\x20class=\x22w-8\x20h-8\x20rounded-full\x22>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22max-w-xs\x20bg-gray-200\x20text-black\x20rounded-lg\x20px-3\x20py-2\x22>','addEventListener','profilePic','Messages','createElement','where','\x22\x20class=\x22w-10\x20h-10\x20rounded-full\x22>\x0a\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>','exists','filter','trim','firestore','\x0a\x20\x20\x20\x20<img\x20src=\x22','</span>\x0a\x20\x20','location','className','collection','user-search-email','then','timestamp','email','textContent','data','doc','messageText','chatId','userId','/assets/img/default_user.jpeg','appendChild','onSnapshot','toLowerCase','forEach','672zpWjrs','\x22\x20class=\x22w-8\x20h-8\x20rounded-full\x22>\x0a\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-400\x22>','push','Users','44PqEbud','get'];a0_0x1d72=function(){return _0x355b53;};return a0_0x1d72();}function a0_0xfa2f(_0x53212f,_0x17973a){const _0x1d7279=a0_0x1d72();return a0_0xfa2f=function(_0xfa2f2,_0x1270af){_0xfa2f2=_0xfa2f2-0xb6;let _0x1be834=_0x1d7279[_0xfa2f2];return _0x1be834;},a0_0xfa2f(_0x53212f,_0x17973a);}searchInput[a0_0x3b37a8(0xee)](a0_0x3b37a8(0xda),_0x4be2ee=>{const _0x59431e=a0_0x3b37a8;updateSidebarList(_0x4be2ee['target'][_0x59431e(0xcf)]);});function add_message(_0x364301,_0x1ffe5a,_0x2d573a,_0x218fb8,_0x5c101c){const _0x1469b=a0_0x3b37a8,_0x551cf3=document[_0x1469b(0xf1)](_0x1469b(0xdb));_0x551cf3[_0x1469b(0xfb)]='flex\x20items-start\x20space-x-3\x20'+(_0x1ffe5a?_0x1469b(0xe7):'');const _0x51eda3=new Date()[_0x1469b(0xeb)]([],{'hour':_0x1469b(0xec),'minute':_0x1469b(0xec)});_0x551cf3[_0x1469b(0xe6)]='\x0a\x20\x20\x20\x20'+(_0x1ffe5a?_0x1469b(0xc7)+_0x5c101c+_0x1469b(0xe0)+_0x51eda3+_0x1469b(0xd1)+_0x218fb8+_0x1469b(0xbd):_0x1469b(0xe1)+_0x218fb8+_0x1469b(0xed)+_0x5c101c+_0x1469b(0xbe)+_0x51eda3+'</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20')+_0x1469b(0xca),chatMessages['appendChild'](_0x551cf3),chatMessages[_0x1469b(0xc3)]=chatMessages['scrollHeight'];}sendButton[a0_0x3b37a8(0xee)](a0_0x3b37a8(0xe8),()=>{const _0x384e0f=a0_0x3b37a8,_0x364f71=chatInput['value'][_0x384e0f(0xf6)]();if(!_0x364f71)return;firebase['firestore']()[_0x384e0f(0xfc)](_0x384e0f(0xf0))[_0x384e0f(0xdd)]({'senderId':CURRENT_USER_ID,'receiverId':activeUserId,'chatId':getChatId(CURRENT_USER_ID,activeUserId),'messageText':_0x364f71,'timestamp':firebase[_0x384e0f(0xf7)]['FieldValue'][_0x384e0f(0xd6)]()}),chatInput[_0x384e0f(0xcf)]='';}),chatInput[a0_0x3b37a8(0xee)]('keydown',_0xa3a6a4=>{const _0x1c331c=a0_0x3b37a8;_0xa3a6a4['key']==='Enter'&&sendButton[_0x1c331c(0xe8)]();});function getChatId(_0x62cdb3,_0x26ceb6){const _0x540d48=a0_0x3b37a8;return[_0x62cdb3,_0x26ceb6][_0x540d48(0xd7)]()[_0x540d48(0xe9)]('-');}function loadChatHistory(_0x18126b){const _0xf4d370=a0_0x3b37a8,_0x3a40b1=getChatId(CURRENT_USER_ID,_0x18126b);unsubscribeMessages&&(unsubscribeMessages(),unsubscribeMessages=null),firebase['firestore']()[_0xf4d370(0xfc)]('Users')[_0xf4d370(0x103)](_0x18126b)[_0xf4d370(0xc2)]()[_0xf4d370(0xfe)](_0x1a311d=>{const _0x29ade0=_0xf4d370,_0x53c94f=_0x1a311d['data'](),_0x10027d=_0x53c94f?.[_0x29ade0(0xc8)]||_0x29ade0(0xd3),_0x8f74d3=_0x53c94f?.[_0x29ade0(0xe4)]||_0x29ade0(0xb7);unsubscribeMessages=firebase['firestore']()[_0x29ade0(0xfc)](_0x29ade0(0xf0))[_0x29ade0(0xf2)](_0x29ade0(0x105),'==',_0x3a40b1)['orderBy'](_0x29ade0(0xff))[_0x29ade0(0xb9)](_0x3e13ef=>{const _0x3902d0=_0x29ade0;chatMessages[_0x3902d0(0xe6)]='',_0x3e13ef[_0x3902d0(0xbb)](_0x1e4008=>{const _0x437407=_0x3902d0,_0x3684b0=_0x1e4008['data'](),_0x362e39=_0x3684b0[_0x437407(0xcc)]===CURRENT_USER_ID,_0x1ab2e7=_0x362e39?CURRENT_USER_NAME:_0x10027d,_0x2f192a=_0x362e39?CURRENT_USER_PIC:_0x8f74d3;add_message(_0x3684b0[_0x437407(0xcc)],_0x362e39,_0x1ab2e7,_0x2f192a,_0x3684b0[_0x437407(0x104)]);});});});}