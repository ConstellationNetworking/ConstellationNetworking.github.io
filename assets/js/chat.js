const a0_0x8c4f52=a0_0x1978;function a0_0x1978(_0x258141,_0x3821db){const _0x243ded=a0_0x243d();return a0_0x1978=function(_0x19784d,_0x368374){_0x19784d=_0x19784d-0x143;let _0x420257=_0x243ded[_0x19784d];return _0x420257;},a0_0x1978(_0x258141,_0x3821db);}(function(_0x5ca2b2,_0x4183e9){const _0x173f35=a0_0x1978,_0x190d4f=_0x5ca2b2();while(!![]){try{const _0x1d2af4=-parseInt(_0x173f35(0x167))/0x1*(parseInt(_0x173f35(0x186))/0x2)+-parseInt(_0x173f35(0x196))/0x3*(-parseInt(_0x173f35(0x198))/0x4)+-parseInt(_0x173f35(0x199))/0x5+parseInt(_0x173f35(0x15a))/0x6*(parseInt(_0x173f35(0x19a))/0x7)+-parseInt(_0x173f35(0x146))/0x8*(-parseInt(_0x173f35(0x15d))/0x9)+parseInt(_0x173f35(0x183))/0xa+-parseInt(_0x173f35(0x16c))/0xb*(parseInt(_0x173f35(0x163))/0xc);if(_0x1d2af4===_0x4183e9)break;else _0x190d4f['push'](_0x190d4f['shift']());}catch(_0x261615){_0x190d4f['push'](_0x190d4f['shift']());}}}(a0_0x243d,0x88c2b));const sidebarList=document['getElementById'](a0_0x8c4f52(0x17d)),chatMessages=document['getElementById'](a0_0x8c4f52(0x159)),chatInput=document[a0_0x8c4f52(0x162)]('chat-input'),sendButton=document['getElementById'](a0_0x8c4f52(0x144)),searchInput=document[a0_0x8c4f52(0x162)]('user-search-email'),allSidebarUsers=[];let CURRENT_USER_ID=null,CURRENT_USER_NAME='',CURRENT_USER_PIC=a0_0x8c4f52(0x17c),lastTimestamp=null,unsubscribeMessages=null;firebase[a0_0x8c4f52(0x150)]()[a0_0x8c4f52(0x170)](async _0x1eb3cf=>{const _0x540bb1=a0_0x8c4f52;if(!_0x1eb3cf)return window[_0x540bb1(0x17a)][_0x540bb1(0x152)]=_0x540bb1(0x178);CURRENT_USER_ID=_0x1eb3cf[_0x540bb1(0x18f)];const _0x48b582=await firebase[_0x540bb1(0x15b)]()[_0x540bb1(0x194)](_0x540bb1(0x173))[_0x540bb1(0x154)](CURRENT_USER_ID)[_0x540bb1(0x169)](),_0x391ae7=_0x48b582[_0x540bb1(0x175)]();CURRENT_USER_NAME=_0x391ae7[_0x540bb1(0x157)]||'You',CURRENT_USER_PIC=_0x391ae7[_0x540bb1(0x17b)]||_0x540bb1(0x17c),loadSidebarFromUserHistory(_0x391ae7['userHistory']||{});const _0x245905=new URLSearchParams(window[_0x540bb1(0x17a)][_0x540bb1(0x15e)]),_0x3d04ca=_0x245905['get'](_0x540bb1(0x15c));_0x3d04ca&&firebase[_0x540bb1(0x15b)]()[_0x540bb1(0x194)](_0x540bb1(0x173))['doc'](_0x3d04ca)['get']()[_0x540bb1(0x16e)](_0x2dfbd1=>{const _0x4d6857=_0x540bb1;if(_0x2dfbd1[_0x4d6857(0x190)]){const _0x272134=_0x2dfbd1[_0x4d6857(0x175)]();document['getElementById'](_0x4d6857(0x187))[_0x4d6857(0x155)]=_0x272134[_0x4d6857(0x157)]||_0x4d6857(0x149),activeUserId=_0x3d04ca,loadChatHistory(_0x3d04ca);}});});function loadSidebarFromUserHistory(_0x3214b2){_0x3214b2['forEach'](_0x4776ea=>{const _0x49e159=a0_0x1978;firebase['firestore']()['collection'](_0x49e159(0x173))[_0x49e159(0x154)](_0x4776ea)['get']()[_0x49e159(0x16e)](_0x1150b2=>{const _0x21b769=_0x49e159;if(_0x1150b2[_0x21b769(0x190)]){const _0x5f0393=_0x1150b2[_0x21b769(0x175)](),_0x2237d7=_0x5f0393['name']||_0x21b769(0x189),_0x3ad419=_0x5f0393['profileIMG']||_0x21b769(0x17c),_0x35e599=_0x5f0393['email']||'';add_to_sidebar(_0x2237d7,_0x3ad419,_0x4776ea,_0x35e599);}});});}function add_to_sidebar(_0x549a22,_0x3e404e,_0x4b474e,_0x261228){const _0x3f4b51=a0_0x8c4f52,_0x58683c=document[_0x3f4b51(0x184)]('li');_0x58683c[_0x3f4b51(0x18e)]=_0x3f4b51(0x172),_0x58683c[_0x3f4b51(0x158)]='\x0a\x20\x20\x20\x20<img\x20src=\x22'+_0x3e404e+'\x22\x20class=\x22w-10\x20h-10\x20rounded-full\x22>\x0a\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>'+_0x549a22+_0x3f4b51(0x17f),_0x58683c[_0x3f4b51(0x193)](_0x3f4b51(0x18d),()=>{const _0xef22ca=_0x3f4b51;document[_0xef22ca(0x162)](_0xef22ca(0x187))[_0xef22ca(0x155)]=_0x549a22,chatMessages[_0xef22ca(0x158)]='',activeUserId=_0x4b474e,loadChatHistory(_0x4b474e);}),sidebarList[_0x3f4b51(0x165)](_0x58683c),allSidebarUsers[_0x3f4b51(0x19b)]({'name':_0x549a22,'profilePic':_0x3e404e,'userId':_0x4b474e,'email':_0x261228});}function updateSidebarList(_0x4ee52d){const _0x3c46cb=a0_0x8c4f52;sidebarList[_0x3c46cb(0x158)]='';const _0x198698=_0x4ee52d[_0x3c46cb(0x143)]();allSidebarUsers['filter'](_0x50b18c=>_0x50b18c['name']['toLowerCase']()[_0x3c46cb(0x14e)](_0x198698)||_0x50b18c[_0x3c46cb(0x148)][_0x3c46cb(0x143)]()[_0x3c46cb(0x14e)](_0x198698)||_0x50b18c[_0x3c46cb(0x177)]['toLowerCase']()['includes'](_0x198698))['forEach'](_0x521ca1=>{const _0x4b7a4f=_0x3c46cb,_0xcbd153=document[_0x4b7a4f(0x184)]('li');_0xcbd153[_0x4b7a4f(0x18e)]='p-4\x20flex\x20items-center\x20space-x-2\x20hover:bg-gray-100\x20cursor-pointer',_0xcbd153[_0x4b7a4f(0x158)]=_0x4b7a4f(0x192)+_0x521ca1['profilePic']+'\x22\x20class=\x22w-10\x20h-10\x20rounded-full\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>'+_0x521ca1[_0x4b7a4f(0x157)]+_0x4b7a4f(0x176),_0xcbd153[_0x4b7a4f(0x193)](_0x4b7a4f(0x18d),()=>{const _0x1ae46e=_0x4b7a4f;document[_0x1ae46e(0x162)](_0x1ae46e(0x187))[_0x1ae46e(0x155)]=_0x521ca1[_0x1ae46e(0x157)],chatMessages[_0x1ae46e(0x158)]='',activeUserId=_0x521ca1[_0x1ae46e(0x148)],loadChatHistory(_0x521ca1[_0x1ae46e(0x148)]);}),sidebarList['appendChild'](_0xcbd153);}),sidebarList['children'][_0x3c46cb(0x153)]===0x0&&_0x4ee52d[_0x3c46cb(0x14e)]('@')&&firebase[_0x3c46cb(0x15b)]()[_0x3c46cb(0x194)]('Users')[_0x3c46cb(0x147)](_0x3c46cb(0x177),'==',_0x4ee52d)[_0x3c46cb(0x169)]()[_0x3c46cb(0x16e)](_0xf6b418=>{const _0x2a84af=_0x3c46cb;if(!_0xf6b418[_0x2a84af(0x151)]){const _0x29066d=_0xf6b418[_0x2a84af(0x14b)][0x0],_0xca9abf=_0x29066d['data'](),_0x1240d1=_0x29066d['id'],_0x36a7ff=_0xca9abf[_0x2a84af(0x157)]||'Unknown',_0x3e3d19=_0xca9abf[_0x2a84af(0x17b)]||_0x2a84af(0x17c),_0x513430=_0xca9abf[_0x2a84af(0x177)]||'';add_to_sidebar(_0x36a7ff,_0x3e3d19,_0x1240d1,_0x513430),updateSidebarList(_0x4ee52d);}});}searchInput[a0_0x8c4f52(0x193)](a0_0x8c4f52(0x14d),_0x6392d4=>{const _0x4a760b=a0_0x8c4f52;updateSidebarList(_0x6392d4[_0x4a760b(0x164)][_0x4a760b(0x182)]);});function add_message(_0x236660,_0x1e2c03,_0x4f55aa,_0x22618e,_0x3e560a){const _0x28be46=a0_0x8c4f52,_0x24de9c=document[_0x28be46(0x184)](_0x28be46(0x181));_0x24de9c[_0x28be46(0x18e)]=_0x28be46(0x195)+(_0x1e2c03?_0x28be46(0x197):'');const _0xf9331c=new Date()['toLocaleTimeString']([],{'hour':'2-digit','minute':_0x28be46(0x14c)});_0x24de9c['innerHTML']=_0x28be46(0x161)+(_0x1e2c03?_0x28be46(0x18b)+_0x3e560a+_0x28be46(0x15f)+_0xf9331c+'</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x22618e+_0x28be46(0x179):_0x28be46(0x188)+_0x22618e+_0x28be46(0x16b)+_0x3e560a+_0x28be46(0x16d)+_0xf9331c+_0x28be46(0x168))+'\x0a\x20\x20',chatMessages[_0x28be46(0x165)](_0x24de9c),chatMessages['scrollTop']=chatMessages[_0x28be46(0x185)];}function a0_0x243d(){const _0x117307=['chat-sidebar-list','keydown','</span>\x0a\x20\x20','Other','div','value','8685750iOtRJk','createElement','scrollHeight','1736teWDzj','chat-header','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22','Unknown','timestamp','\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20flex-col\x20items-end\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22max-w-xs\x20bg-blue-500\x20text-white\x20rounded-lg\x20px-3\x20py-2\x22>','orderBy','click','className','uid','exists','Messages','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','addEventListener','collection','flex\x20items-start\x20space-x-3\x20','9QGmsmV','justify-end','771184dVgsAc','4044360JsDFrp','1337TUkjsj','push','toLowerCase','send-btn','join','1768128omlUlG','where','userId','Chat','onSnapshot','docs','2-digit','input','includes','chatId','auth','empty','href','length','doc','textContent','Enter','name','innerHTML','chat-messages','32844xzPIWg','firestore','chat','18fvGXuL','search','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-400\x20mt-1\x22>','forEach','\x0a\x20\x20\x20\x20','getElementById','24cbNOFO','target','appendChild','add','235SyuWGa','</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','get','messageText','\x22\x20class=\x22w-8\x20h-8\x20rounded-full\x22>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22max-w-xs\x20bg-gray-200\x20text-black\x20rounded-lg\x20px-3\x20py-2\x22>','7488283eafGdQ','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-400\x22>','then','key','onAuthStateChanged','sort','p-4\x20flex\x20items-center\x20space-x-2\x20hover:bg-gray-100\x20cursor-pointer','Users','FieldValue','data','</span>\x0a\x20\x20\x20\x20\x20\x20','email','/signin.html','\x22\x20class=\x22w-8\x20h-8\x20rounded-full\x22>\x0a\x20\x20\x20\x20','location','profileIMG','/assets/img/default_user.jpeg'];a0_0x243d=function(){return _0x117307;};return a0_0x243d();}sendButton[a0_0x8c4f52(0x193)](a0_0x8c4f52(0x18d),()=>{const _0x46b2b1=a0_0x8c4f52,_0x536202=chatInput[_0x46b2b1(0x182)]['trim']();if(!_0x536202)return;firebase[_0x46b2b1(0x15b)]()[_0x46b2b1(0x194)](_0x46b2b1(0x191))[_0x46b2b1(0x166)]({'senderId':CURRENT_USER_ID,'receiverId':activeUserId,'chatId':getChatId(CURRENT_USER_ID,activeUserId),'messageText':_0x536202,'timestamp':firebase['firestore']['FieldValue']['serverTimestamp']()}),firebase[_0x46b2b1(0x15b)]()[_0x46b2b1(0x194)](_0x46b2b1(0x173))['doc'](CURRENT_USER_ID)['update']({'userHistory':firebase[_0x46b2b1(0x15b)][_0x46b2b1(0x174)]['arrayUnion'](activeUserId)}),chatInput[_0x46b2b1(0x182)]='';}),chatInput[a0_0x8c4f52(0x193)](a0_0x8c4f52(0x17e),_0x47d10a=>{const _0x49d588=a0_0x8c4f52;_0x47d10a[_0x49d588(0x16f)]===_0x49d588(0x156)&&sendButton[_0x49d588(0x18d)]();});function getChatId(_0x512df7,_0x41d910){const _0x32c974=a0_0x8c4f52;return[_0x512df7,_0x41d910][_0x32c974(0x171)]()[_0x32c974(0x145)]('-');}function loadChatHistory(_0x332fc0){const _0x5c25d9=a0_0x8c4f52,_0x176488=getChatId(CURRENT_USER_ID,_0x332fc0);unsubscribeMessages&&(unsubscribeMessages(),unsubscribeMessages=null),firebase[_0x5c25d9(0x15b)]()['collection'](_0x5c25d9(0x173))[_0x5c25d9(0x154)](_0x332fc0)[_0x5c25d9(0x169)]()[_0x5c25d9(0x16e)](_0x4acd6b=>{const _0x1eea32=_0x5c25d9,_0x4e178c=_0x4acd6b['data'](),_0x990f0e=_0x4e178c?.['name']||_0x1eea32(0x180),_0x5d7b87=_0x4e178c?.['profileIMG']||_0x1eea32(0x17c);unsubscribeMessages=firebase['firestore']()[_0x1eea32(0x194)](_0x1eea32(0x191))[_0x1eea32(0x147)](_0x1eea32(0x14f),'==',_0x176488)[_0x1eea32(0x18c)](_0x1eea32(0x18a))[_0x1eea32(0x14a)](_0x438d47=>{const _0x27be42=_0x1eea32;chatMessages[_0x27be42(0x158)]='',_0x438d47[_0x27be42(0x160)](_0x261a17=>{const _0x5b1766=_0x27be42,_0x78cf87=_0x261a17[_0x5b1766(0x175)](),_0x33c9d9=_0x78cf87['senderId']===CURRENT_USER_ID,_0x2ce3cb=_0x33c9d9?CURRENT_USER_NAME:_0x990f0e,_0x5a5069=_0x33c9d9?CURRENT_USER_PIC:_0x5d7b87;add_message(_0x78cf87['senderId'],_0x33c9d9,_0x2ce3cb,_0x5a5069,_0x78cf87[_0x5b1766(0x16a)]);});});});}